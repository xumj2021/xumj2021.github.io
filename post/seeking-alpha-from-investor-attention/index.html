<!DOCTYPE html>
<html lang="en-us">
<head>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-309KENXF47"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-309KENXF47');
    </script>

    
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" integrity="sha384-Juol1FqnotbkyZUT5Z7gUPjQ9gzlwCENvUZTpQBAPxtusdwFLRy382PSDx5UUJ4/" crossorigin="anonymous">

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.js" integrity="sha384-97gW6UIJxnlKemYavrqDHSX3SiygeOwIZhwyOKRfSaf0JWKRVj9hLASHgFTzT+0O" crossorigin="anonymous"></script>

    
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Democratize Data For Insights">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://assets.bbhub.io/image/v1/convert?type=auto&amp;amp;url=https%3A%2F%2Fassets.bbhub.io%2Fprofessional%2Fsites%2F10%2FYOTA-Key-Art3-1.png">
    <meta property="twitter:image" content="https://assets.bbhub.io/image/v1/convert?type=auto&amp;amp;url=https%3A%2F%2Fassets.bbhub.io%2Fprofessional%2Fsites%2F10%2FYOTA-Key-Art3-1.png" />
    

    
    <meta name="title" content="Seeking Alpha From Market Participants&#39; Information Acquisition Actions" />
    <meta property="og:title" content="Seeking Alpha From Market Participants&#39; Information Acquisition Actions" />
    <meta property="twitter:title" content="Seeking Alpha From Market Participants&#39; Information Acquisition Actions" />
    

    
    <meta name="description" content="Trace information acquisition actions of both retail and institutional investors">
    <meta property="og:description" content="Trace information acquisition actions of both retail and institutional investors" />
    <meta property="twitter:description" content="Trace information acquisition actions of both retail and institutional investors" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="Mengjie, Xu, Python, Stata, SAS, Econometrics, Accounting, Crawling">
    <link rel="shortcut icon" href="/img/favicon.png.ico">

    <title>Mengjie Xu | Democratize Data For Insights</title>

    <link rel="canonical" href="/post/seeking-alpha-from-investor-attention/">

    
    
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hugo-theme-cleanwhite.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link rel="stylesheet" href="/css/font-awesome.all.min.css">

    
    

    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    <script src="/js/lazysizes.min.js"></script>

    
    

</head>






<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Home</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                       
                    </li>
                    
                        
                        <li>
                            <a href="/categories/anecdotes/">anecdotes</a>
                        </li>
                        
                        <li>
                            <a href="/categories/crawler/">crawler</a>
                        </li>
                        
                        <li>
                            <a href="/categories/data/">data</a>
                        </li>
                        
                        <li>
                            <a href="/categories/theory/">theory</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/about//">ABOUT</a></li>
                    
		            <li>
                       
		           </li>
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('https://assets.bbhub.io/image/v1/convert?type=auto&amp;url=https%3A%2F%2Fassets.bbhub.io%2Fprofessional%2Fsites%2F10%2FYOTA-Key-Art3-1.png')
    }
</style>

<header class="intro-header" >

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/information-acquisition" title="Information Acquisition">
                            Information Acquisition
                        </a>
                        
                        <a class="tag" href="/tags/google-search-volume" title="Google Search Volume">
                            Google Search Volume
                        </a>
                        
                        <a class="tag" href="/tags/bloomberg" title="Bloomberg">
                            Bloomberg
                        </a>
                        
                    </div>
                    <h1>Seeking Alpha From Market Participants&#39; Information Acquisition Actions</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        
                            Posted by 
                            
                                Mengjie Xu
                             
                            on 
                            Thursday, September 8, 2022
                            
                            
                            
                            
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <h2 id="motivation">Motivation</h2>
<p>Just like the trading imbalance could be a powerful signal for upcoming stock price movement, investors&rsquo; information acquisition actions are also indicative for future security returns. According to Lee and So (2015), acquiring information is costly for investors and thus they only do so when the expected profits can cover the relative costs. Ceteris paribus, securities which attract more investor attention may have a higher likelihood of experiencing abnormal stock volatility from which a sophisticated investor can cultivate Alphas.</p>
<p>The information content of investors&rsquo; information acquisition actions has been well validated by a series of papers. For example, Da, Engelberg, and Gao (2011, JF) utilize search frequency in Google (Search Volume Index (SVI)) as a proxy for investor attention and show that firms with abnormally bigger Google search volume are more likely to have a higher stock price in the next 2 weeks and an eventual price reversal within the year, suggesting that the Google search volume may mainly capture the less sophisticated retail investors&rsquo; attention. Similarly, Drake, Johnson, Roulstone, and Thornock (2020, TAR) find that downloads number of a firm&rsquo;s company filings filed in the EDGAR is significantly predictive of its subsequent performance and the predictive power is mainly driven by downloads from institutional investors&rsquo; IP address.</p>
<p>Employing news searching and news reading intensity for specific stocks on Bloomberg terminals as a new proxy for institutional investor attention, Ben-Rephael, Da, Israelsen (2017, RFS) and Easton, Ben-Repahael, Da, Israelsen (2021, TAR) more explicitly illustrated the lead-lag relationship between retail attention and institutional attention, suggesting that institutional investors are typically aware of the material firm-specific information earlier than retail investors and tend to make use of their information advantage by opportunistically providing liquidity when price pressure induced by retail investors arrives.</p>
<p>The take away from the literature is that by observing different market participants&rsquo; information acquisition actions in time-series, one can not only trace back how  the current stock price was previously formulated, but also gain insights about how the stock price will evolve in the future.</p>
<p>The idea that predicting the stock movement from current market participants&rsquo; information acquisition actions, in my opinion, is especially fascinating: even though you have no idea about what exactly has happened to a specific firm, you could still get sense that there must be something abnormal when observing some unsual information acquisition actions targeted toward this firm in the market. From this perspective, approachable records of market participants&rsquo; information acquisition actions per se may facilitate the implicit dissemination of non-public material information in the market.</p>
<p>Take the stylized facts documented by Easton, Ben-Repahael, Da, Israelsen (2021, TAR) as an example. Figure 1 shows that when something material happens and a firm is obliged to file a 8-K to the SEC, one can always get informed days earlier than the publication of the 8-K filing by observing the abnormal Bloomberg Read Heat, depsite that he/she has no idea about what exactly has happened to the firm. Given the significant price pressure after the publication of 8-Ks, the information advantage means (potentially huge) trading profits.</p>
<center>
      <img style="border-radius: 0.3125em;
      box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
      src="https://fig-lianxh.oss-cn-shenzhen.aliyuncs.com/AIA2.png" width=1000 height=400>
      <br>
      <div style="color:orange; border-bottom: 1px solid #d9d9d9;
      display: inline-block;
      color: #999;
      padding: 2px;">Figure 1: Alphas From Abnormal Information Acquisition Actions</div>
  </center>
<p>In this blog, I will introduce how to collect data and formulate the weekly measure for retail/institutional information acquisition actions. In particular, following Ben-Rephael, Da, Israelsen (2017, RFS) and Easton, Ben-Repahael, Da, Israelsen (2021, TAR), I will use Google Search Volume Index (SVI) to capture retail attention and Bloomberg institutional investors&rsquo; read heat to capture institutional information acquisition actions.</p>
<h2 id="formulate-retail-information-acquisition-measure-svi">Formulate Retail Information Acquisition Measure (SVI)</h2>
<p>As far as I know, the Google Search Volume Index (SVI) started to be recognized as a reasonable proxy for retail investors&rsquo; attention/information acquisition intensity in accounting and finance literature after the publication of Da, Engelberg, and Gao (2011, JF). The idea is that while institutional investors have more advanced platforms to gather information (e.g., Bloomberg, Reuters, etc), the majority of retail investors have to count on the Google search engine for information acquisition. Actually, the authors did find &ldquo;a strong and direct link&rdquo; between Google Search Volume Index (SVI) and retail order execution.</p>
<p>Following Da, Engelberg, and Gao (2011, JF), I will collect the weekly Google Search Volume Index (SVI) for each stock symbol, which could be then used for calculating the abnormal retail attention ASVI by substracting the rolling-average in the past 8 weeks from the current-week Google Search Volume Index (SVI).</p>
<h3 id="analyse-google-trends-website">Analyse Google Trends Website</h3>
<h4 id="manual-search">Manual Search</h4>
<p>Firstly, let&rsquo;s randomly post two stock symbols and a date range and analyze how Google Trends API reacts to our post. Here I use tickers of Apple and Amazon, AAPL and AMZN, as search keywords. The date range is randomly specified as &ldquo;2021-08-08 2022-08-08&rdquo;.</p>
<center>
      <img style="border-radius: 0.3125em;
      box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
      src="https://fig-lianxh.oss-cn-shenzhen.aliyuncs.com/image-20220908170125179.png" width=1000 height=800>
      <br>
      <div style="color:orange; border-bottom: 1px solid #d9d9d9;
      display: inline-block;
      color: #999;
      padding: 2px;">Figure 2: Analysis Webpage</div>
  </center>
<p>Figure 2 shows that the time series of the Search Volume Index is returned with <code>json</code> format and should contain ingredients when requesting as follows. In addition, one can also easily find out the cookies in the rendering results of the same reuqest.</p>
<p>Request method: <code>GET</code></p>
<p>Base url: <code>https://trends.google.com/trends/api/widgetdata/multiline</code></p>
<p>Request parameters:</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-19">19</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>	&#34;GET&#34;: {
</span></span><span style="display:flex;"><span>		&#34;scheme&#34;: &#34;https&#34;,
</span></span><span style="display:flex;"><span>		&#34;host&#34;: &#34;trends.google.com&#34;,
</span></span><span style="display:flex;"><span>		&#34;filename&#34;: &#34;/trends/api/widgetdata/multiline&#34;,
</span></span><span style="display:flex;"><span>		&#34;query&#34;: {
</span></span><span style="display:flex;"><span>			&#34;hl&#34;: &#34;en-US&#34;,
</span></span><span style="display:flex;"><span>			&#34;tz&#34;: [
</span></span><span style="display:flex;"><span>				&#34;-120&#34;,
</span></span><span style="display:flex;"><span>				&#34;-120&#34;
</span></span><span style="display:flex;"><span>			],
</span></span><span style="display:flex;"><span>			&#34;req&#34;: &#34;{\&#34;time\&#34;:\&#34;2021-08-08 2022-08-08\&#34;,\&#34;resolution\&#34;:\&#34;WEEK\&#34;,\&#34;locale\&#34;:\&#34;en-US\&#34;,\&#34;comparisonItem\&#34;:[{\&#34;geo\&#34;:{},\&#34;complexKeywordsRestriction\&#34;:{\&#34;keyword\&#34;:[{\&#34;type\&#34;:\&#34;BROAD\&#34;,\&#34;value\&#34;:\&#34;aapl\&#34;}]}},{\&#34;geo\&#34;:{},\&#34;complexKeywordsRestriction\&#34;:{\&#34;keyword\&#34;:[{\&#34;type\&#34;:\&#34;BROAD\&#34;,\&#34;value\&#34;:\&#34;amzn\&#34;}]}}],\&#34;requestOptions\&#34;:{\&#34;property\&#34;:\&#34;\&#34;,\&#34;backend\&#34;:\&#34;IZG\&#34;,\&#34;category\&#34;:0},\&#34;userConfig\&#34;:{\&#34;userType\&#34;:\&#34;USER_TYPE_LEGIT_USER\&#34;}}&#34;,
</span></span><span style="display:flex;"><span>			&#34;token&#34;: &#34;APP6_UEAAAAAYxtcSHr7t2vjq6DYGSssMOgl0W-lpj05&#34;
</span></span><span style="display:flex;"><span>		},
</span></span><span style="display:flex;"><span>		&#34;remote&#34;: {
</span></span><span style="display:flex;"><span>			&#34;Address&#34;: &#34;xxx.250.186.132:443&#34;
</span></span><span style="display:flex;"><span>		}
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>By fetching the response message of the rendered url in the web browser, we can figure out the headers and the exact request url.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-14">14</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>await fetch(&#34;https://trends.google.com/trends/api/widgetdata/multiline?hl=en-US&amp;tz=-120&amp;req=%7B%22time%22:%222021-08-08+2022-08-08%22,%22resolution%22:%22WEEK%22,%22locale%22:%22en-US%22,%22comparisonItem%22:%5B%7B%22geo%22:%7B%7D,%22complexKeywordsRestriction%22:%7B%22keyword%22:%5B%7B%22type%22:%22BROAD%22,%22value%22:%22aapl%22%7D%5D%7D%7D,%7B%22geo%22:%7B%7D,%22complexKeywordsRestriction%22:%7B%22keyword%22:%5B%7B%22type%22:%22BROAD%22,%22value%22:%22amzn%22%7D%5D%7D%7D%5D,%22requestOptions%22:%7B%22property%22:%22%22,%22backend%22:%22IZG%22,%22category%22:0%7D,%22userConfig%22:%7B%22userType%22:%22USER_TYPE_LEGIT_USER%22%7D%7D&amp;token=APP6_UEAAAAAYxtQ5U8DMlPHqyrSyWpmr2xkJaQQ-Ahb&amp;tz=-120&#34;, {
</span></span><span style="display:flex;"><span>    &#34;credentials&#34;: &#34;include&#34;,
</span></span><span style="display:flex;"><span>    &#34;headers&#34;: {
</span></span><span style="display:flex;"><span>        &#34;User-Agent&#34;: &#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0&#34;,
</span></span><span style="display:flex;"><span>        &#34;Accept&#34;: &#34;application/json, text/plain, */*&#34;,
</span></span><span style="display:flex;"><span>        &#34;Accept-Language&#34;: &#34;en-US,en;q=0.5&#34;,
</span></span><span style="display:flex;"><span>        &#34;Sec-Fetch-Dest&#34;: &#34;empty&#34;,
</span></span><span style="display:flex;"><span>        &#34;Sec-Fetch-Mode&#34;: &#34;cors&#34;,
</span></span><span style="display:flex;"><span>        &#34;Sec-Fetch-Site&#34;: &#34;same-origin&#34;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    &#34;referrer&#34;: &#34;https://trends.google.com/trends/explore?date=2021-08-08%202022-08-08&amp;q=aapl,amzn&#34;,
</span></span><span style="display:flex;"><span>    &#34;method&#34;: &#34;GET&#34;,
</span></span><span style="display:flex;"><span>    &#34;mode&#34;: &#34;cors&#34;
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></td></tr></table>
</div>
</div><p>After the simple decoding of the request url, one can find out the request url is exactly the combination of the base url and specified parameters.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>https://trends.google.com/trends/api/widgetdata/multiline?hl=en-US&amp;tz=-120&amp;req={&#34;time&#34;:&#34;2021-08-08+2022-08-08&#34;,&#34;resolution&#34;:&#34;WEEK&#34;,&#34;locale&#34;:&#34;en-US&#34;,&#34;comparisonItem&#34;:[{&#34;geo&#34;:{},&#34;complexKeywordsRestriction&#34;:{&#34;keyword&#34;:[{&#34;type&#34;:&#34;BROAD&#34;,&#34;value&#34;:&#34;aapl&#34;}]}},{&#34;geo&#34;:{},&#34;complexKeywordsRestriction&#34;:{&#34;keyword&#34;:[{&#34;type&#34;:&#34;BROAD&#34;,&#34;value&#34;:&#34;amzn&#34;}]}}],&#34;requestOptions&#34;:{&#34;property&#34;:&#34;&#34;,&#34;backend&#34;:&#34;IZG&#34;,&#34;category&#34;:0},&#34;userConfig&#34;:{&#34;userType&#34;:&#34;USER_TYPE_LEGIT_USER&#34;}}&amp;token=APP6_UEAAAAAYxtQ5U8DMlPHqyrSyWpmr2xkJaQQ-Ahb&amp;tz=-120
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="analyze-parameter-structure">Analyze Parameter Structure</h4>
<p>A typical set of post parameters is as follows.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-6">6</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>hl: en-US
</span></span><span style="display:flex;"><span>tz[...]
</span></span><span style="display:flex;"><span>0:-120
</span></span><span style="display:flex;"><span>1:-120
</span></span><span style="display:flex;"><span>req:{&#34;time&#34;:&#34;2021-08-08 2022-08-08&#34;,&#34;resolution&#34;:&#34;WEEK&#34;,&#34;locale&#34;:&#34;en-US&#34;,&#34;comparisonItem&#34;:[{&#34;geo&#34;:{},&#34;complexKeywordsRestriction&#34;:{&#34;keyword&#34;:[{&#34;type&#34;:&#34;BROAD&#34;,&#34;value&#34;:&#34;aapl&#34;}]}},{&#34;geo&#34;:{},&#34;complexKeywordsRestriction&#34;:{&#34;keyword&#34;:[{&#34;type&#34;:&#34;BROAD&#34;,&#34;value&#34;:&#34;amzn&#34;}]}}],&#34;requestOptions&#34;:{&#34;property&#34;:&#34;&#34;,&#34;backend&#34;:&#34;IZG&#34;,&#34;category&#34;:0},&#34;userConfig&#34;:{&#34;userType&#34;:&#34;USER_TYPE_LEGIT_USER&#34;}}
</span></span><span style="display:flex;"><span>token: APP6_UEAAAAAYxtQ5U8DMlPHqyrSyWpmr2xkJaQQ-Ahb
</span></span></code></pre></td></tr></table>
</div>
</div><p>My little experiment shows that there are in general three components of the parameters.</p>
<ol>
<li>
<p>Relatively Fixed Part</p>
<ul>
<li>The parameter <code>hl</code> specifies host language for accessing Google Trends, by default <code>en-US</code></li>
<li>The parameter <code>tz</code> specifies time zone offset (in minutes). For example <code>360</code> means UTC -6 which is US CST</li>
</ul>
</li>
</ol>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-4">4</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hl: en-US
</span></span><span style="display:flex;"><span>tz<span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>0:-120
</span></span><span style="display:flex;"><span>1:-120
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>
<p>Variable Core Part</p>
<ul>
<li>
<p>The parameter <code>req</code> consists of the following sub-parameters</p>
<ul>
<li>
<p><code>time</code>: time frame for search, in our sample case is <code>2021-08-08 2022-08-08</code></p>
</li>
<li>
<p><code>resolution</code>: frequency of returned time series, in our sample case is <code>WEEK</code>, could also be <code>HOUR</code>, <code>DAY</code> or <code>MONTH</code>. There are different limitations for the span of the date range under different resolution levels.</p>
</li>
<li>
<p><code>locale</code>: <code>en-US</code>, same as <code>hl</code></p>
</li>
<li>
<p><code>comparisonItem</code>: information about the search keywords, each keyword has a parallel complete post structure with following format</p>
</li>
</ul>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    <span style="color:#f92672">{</span><span style="color:#d88200">&#34;geo&#34;</span>:<span style="color:#f92672">{}</span>,<span style="color:#d88200">&#34;complexKeywordsRestriction&#34;</span>:<span style="color:#f92672">{</span><span style="color:#d88200">&#34;keyword&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#d88200">&#34;type&#34;</span>:<span style="color:#d88200">&#34;BROAD&#34;</span>,<span style="color:#d88200">&#34;value&#34;</span>:<span style="color:#d88200">&#34;aapl&#34;</span><span style="color:#f92672">}]}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p><code>requestOptions</code>: typically fixed<code>{&quot;property&quot;:&quot;&quot;,&quot;backend&quot;:&quot;IZG&quot;,&quot;category&quot;:0}</code></p>
</li>
<li>
<p><code>userConfig</code>: <code>{&quot;userType&quot;:&quot;USER_TYPE_LEGIT_USER&quot;}</code>. Might be different if you post those parameters using algorithms. I will elaborate the details later.</p>
</li>
</ul>
</li>
<li>
<p>The parameter <code>token</code> is the password for configuration from Google. This encrypted parameter needs another request. I will elaborate the details later.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>token: APP6_UEAAAAAYxtQ5U8DMlPHqyrSyWpmr2xkJaQQ-Ahb
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ol>
<p>In sum, we can fill most parameters with the information we have in hand, such as the keyword list [&lsquo;AAPL&rsquo;, &lsquo;AMZN&rsquo;] and the search range <code>2021-08-08 2022-08-08</code>. The only obstacle left is that we have no idea how does Google encrypts those parameters and generate the dynamic secrets <code>token</code>.</p>
<p>Don&rsquo;t worry. I will show how to get access to those encrypted tokens in the next subsection.</p>
<h4 id="find-out-tokens">Find Out Tokens</h4>
<p>With more checks on the page source, I find that the tokens are also returned with the format of <code>json</code> and can be accessed by posting the basic searching parameters to another url <code>https://trends.google.com/trends/api/explore</code>.</p>
<center>
      <img style="border-radius: 0.3125em;
      box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" 
      src="https://fig-lianxh.oss-cn-shenzhen.aliyuncs.com/image-20220908173247593.png" width=1000 height=180>
      <br>
      <div style="color:orange; border-bottom: 1px solid #d9d9d9;
      display: inline-block;
      color: #999;
      padding: 2px;">Figure 3: Find Out Tokens</div>
  </center>
<p>With the similar procedures as those in the previous subsection. I find the parameter structure for this request is as follows.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-18">18</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">&#34;POST&#34;</span><span style="color:#111">:</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>   	<span style="color:#f92672">&#34;scheme&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;https&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>   	<span style="color:#f92672">&#34;host&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;trends.google.com&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>   	<span style="color:#f92672">&#34;filename&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;/trends/api/explore&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>   	<span style="color:#f92672">&#34;query&#34;</span><span style="color:#111">:</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>   		<span style="color:#f92672">&#34;hl&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;en-US&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>   		<span style="color:#f92672">&#34;tz&#34;</span><span style="color:#111">:</span> <span style="color:#111">[</span>
</span></span><span style="display:flex;"><span>   			<span style="color:#d88200">&#34;-120&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>   			<span style="color:#d88200">&#34;-120&#34;</span>
</span></span><span style="display:flex;"><span>   		<span style="color:#111">],</span>
</span></span><span style="display:flex;"><span>   		<span style="color:#f92672">&#34;req&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;{\&#34;comparisonItem\&#34;:[{\&#34;keyword\&#34;:\&#34;aapl\&#34;,\&#34;geo\&#34;:\&#34;\&#34;,\&#34;time\&#34;:\&#34;2021-08-08 2022-08-08\&#34;},{\&#34;keyword\&#34;:\&#34;amzn\&#34;,\&#34;geo\&#34;:\&#34;\&#34;,\&#34;time\&#34;:\&#34;2021-08-08 2022-08-08\&#34;}],\&#34;category\&#34;:0,\&#34;property\&#34;:\&#34;\&#34;}&#34;</span>
</span></span><span style="display:flex;"><span>   	<span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>   	<span style="color:#f92672">&#34;remote&#34;</span><span style="color:#111">:</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>   		<span style="color:#f92672">&#34;Address&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;142.250.186.132:443&#34;</span>
</span></span><span style="display:flex;"><span>   	<span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span><span style="color:#111">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Apparently, there is no information that is beyond our information set in this set of parameters.</p>
<p>The compressed returned json is as follows, from which one can easily find out the tokens and all the other parameters in need. Note that in addition to the time series of Google Search Index, this request also returns tokens for other type of information, such as data of geographical distribution<code>GEO_MAP</code> and keyword lists that are typically searched together with the focal keyword<code>RELATED_QUERIES</code>. Here I only display returned information, especially the token, for time series of Google Search Index.</p>
<p>Simply compare the following returned json in this subsection and the request parameters for the extracting of the time series data in the previous subsection, one will find that all the core variable parameters, <code>req</code> and <code>token</code>, needed in the previous subsection are contained in the following returned json.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-47">47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-48">48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-49">49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-50">50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-51">51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-52">52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-53">53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-54">54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-55">55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-56">56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-57">57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-58">58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-59"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-59">59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-60"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-60">60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-61"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-61">61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-62"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-62">62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-63"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-63">63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-64"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-64">64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-65"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-65">65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-66"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-66">66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-67"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-67">67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-68"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-68">68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-69"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-69">69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-70"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-70">70</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;widgets&#34;</span><span style="color:#111">:[</span>
</span></span><span style="display:flex;"><span>     <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;request&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;time&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;2021-08-08 2022-08-08&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;resolution&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;WEEK&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;locale&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;en-US&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;comparisonItem&#34;</span><span style="color:#111">:[</span>
</span></span><span style="display:flex;"><span>              <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">&#34;geo&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                 <span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">&#34;complexKeywordsRestriction&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;keyword&#34;</span><span style="color:#111">:[</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#f92672">&#34;type&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;BROAD&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#f92672">&#34;value&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;aapl&#34;</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>              <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">&#34;geo&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>                    
</span></span><span style="display:flex;"><span>                 <span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#f92672">&#34;complexKeywordsRestriction&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">&#34;keyword&#34;</span><span style="color:#111">:[</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#f92672">&#34;type&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;BROAD&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                          <span style="color:#f92672">&#34;value&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;amzn&#34;</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>                 <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>              <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">],</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;requestOptions&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;property&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;backend&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;IZG&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;category&#34;</span><span style="color:#111">:</span><span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;userConfig&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;userType&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;USER_TYPE_LEGIT_USER&#34;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;lineAnnotationText&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;Search interest&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;bullets&#34;</span><span style="color:#111">:[</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;text&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;aapl&#34;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>              <span style="color:#f92672">&#34;text&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;amzn&#34;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">],</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;showLegend&#34;</span><span style="color:#111">:</span><span style="color:#00a8c8">false</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;showAverages&#34;</span><span style="color:#111">:</span><span style="color:#00a8c8">true</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;helpDialog&#34;</span><span style="color:#111">:{</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;title&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;Interest over time&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">&#34;content&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;Numbers represent search interest relative to the highest point on the chart for the given region and time. A value of 100 is the peak popularity for the term. A value of 50 means that the term is half as popular. A score of 0 means there was not enough data for this term.&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">},</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;token&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;APP6_UEAAAAAYxtcSHr7t2vjq6DYGSssMOgl0W-lpj05&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;id&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;TIMESERIES&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;type&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;fe_line_chart&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;title&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;Interest over time&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;template&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;fe&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;embedTemplate&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;fe_embed&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;version&#34;</span><span style="color:#111">:</span><span style="color:#d88200">&#34;1&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;isLong&#34;</span><span style="color:#111">:</span><span style="color:#00a8c8">true</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;isCurated&#34;</span><span style="color:#111">:</span><span style="color:#00a8c8">false</span>
</span></span><span style="display:flex;"><span>     <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>     <span style="color:#111">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="algorithm">Algorithm</h3>
<p>For now, we have figured out all the necessary ingredients for writing the algorithm of automating the downloads of Google Search Volume Index (SVI).</p>
<p><strong>Step 0</strong>: Define global variables that will be repeatedly used.</p>
<p><strong>Step 1</strong>: Post the search keywords as well as the date range to <code>https://trends.google.com/trends/api/explore</code> and get the tokens as well as the parameters for the next step.</p>
<p><strong>Step 2</strong>: Use the parameters obtained in Step 1 to obtain the time series Google Search Volume Index from <code>https://trends.google.com/trends/api/widgetdata/multiline</code></p>
<p><strong>Step 3</strong>: Clean the raw time series data and write it into the file.</p>
<h4 id="step-0-define-global-variables">Step 0: Define global variables</h4>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-26">26</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00a8c8">class</span> <span style="color:#75af00">gtparas</span><span style="color:#111">(</span><span style="color:#111">object</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">tokenurl</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;https://trends.google.com/trends/api/explore&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">tsurl</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;https://trends.google.com/trends/api/widgetdata/multiline&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">headers</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;User-Agent&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Accept&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Accept-Language&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;en-US,en;q=0.5&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Alt-Used&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;trends.google.com&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Upgrade-Insecure-Requests&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;1&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Sec-Fetch-Dest&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;document&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Sec-Fetch-Mode&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;navigate&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Sec-Fetch-Site&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;none&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>               <span style="color:#d88200">&#34;Sec-Fetch-User&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;?1&#34;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">cookies</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;AEC&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;AakniGMZ6nXlsuXNYf-cVEy-z26kpLEg-_E-OHRlDx-o4ApEe6xoCanQRw&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;CONSENT&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;PENDING+772&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;SOCS&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;CAISHAgBEhJnd3NfMjAyMjA4MzEtMF9SQzEaAmRlIAEaBgiA1c-YBg&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;NID&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;511=BOJuzRwaQjxlv1xhQxBRom1aMkVL7CFU1RzfvcARIcHraZHPpuF_ZuCoFJ0YlmH18CbkapTUPEjBR6wm-U15jn_OT4yiyLy5WuMlBVvfSA7FNZ_tvrteTBgHRwXJcfJCC1VhZ0RbWlV881OpXOae007aMkwxgcjaGOZUEdQpd5NTV03c52iMD2jtVJUIyvsg6zU&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;__utmc&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;__utmt&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;1&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;__utma&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256.1871926219.1662307048.1662307048.1662307048.1&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;__utmb&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256.2.9.1662307053878&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#d88200">&#34;__utmz&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256.1662307048.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)&#34;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>   
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="step-1-get-tokens">Step 1: Get Tokens</h4>
<p>Input:</p>
<ul>
<li><code>kw_list</code>: keyword list, must be lower case, at maximum 5, e.g., <code>['appl', 'amzn']</code></li>
<li><code>daterange</code>: search range, with format like <code>2021-08-08 2022-08-08</code></li>
</ul>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-16">16</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">getoken</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">,</span> <span style="color:#111">daterange</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">token_payload</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>           <span style="color:#d88200">&#39;hl&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;en-US&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>           <span style="color:#d88200">&#39;tz&#39;</span><span style="color:#111">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">120</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>           <span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">:</span> <span style="color:#111">{</span><span style="color:#d88200">&#39;comparisonItem&#39;</span><span style="color:#111">:</span> <span style="color:#111">[],</span> <span style="color:#d88200">&#39;category&#39;</span><span style="color:#111">:</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;property&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>       <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>   <span style="color:#00a8c8">for</span> <span style="color:#111">kw</span> <span style="color:#f92672">in</span> <span style="color:#111">kw_list</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>       <span style="color:#111">keyword_payload</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#d88200">&#39;keyword&#39;</span><span style="color:#111">:</span> <span style="color:#111">kw</span><span style="color:#f92672">.</span><span style="color:#111">lower</span><span style="color:#111">(),</span> <span style="color:#d88200">&#39;geo&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                              <span style="color:#d88200">&#39;time&#39;</span><span style="color:#111">:</span> <span style="color:#111">daterange</span><span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>       <span style="color:#111">token_payload</span><span style="color:#111">[</span><span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">][</span><span style="color:#d88200">&#39;comparisonItem&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">keyword_payload</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">token_payload</span><span style="color:#111">[</span><span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">dumps</span><span style="color:#111">(</span><span style="color:#111">token_payload</span><span style="color:#111">[</span><span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">])</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>   <span style="color:#111">con</span> <span style="color:#f92672">=</span> <span style="color:#111">requests</span><span style="color:#f92672">.</span><span style="color:#111">post</span><span style="color:#111">(</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">tokenurl</span><span style="color:#111">,</span> <span style="color:#111">headers</span> <span style="color:#f92672">=</span> <span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">headers</span><span style="color:#111">,</span> <span style="color:#111">cookies</span><span style="color:#f92672">=</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">cookies</span><span style="color:#111">,</span> <span style="color:#111">params</span> <span style="color:#f92672">=</span> <span style="color:#111">token_payload</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">widgets</span> <span style="color:#f92672">=</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">loads</span><span style="color:#111">(</span><span style="color:#111">con</span><span style="color:#f92672">.</span><span style="color:#111">text</span><span style="color:#111">[</span><span style="color:#ae81ff">5</span><span style="color:#111">:])[</span><span style="color:#d88200">&#39;widgets&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#111">recordtokens</span><span style="color:#111">(</span><span style="color:#111">widgets</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>   <span style="color:#00a8c8">return</span> <span style="color:#111">reqparas</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In case one also want to obtain other type of information such as the geographical distribution of the Google search, I recorded all the returned tokens and parameters in this step.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-11-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-11-10">10</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">recordtokens</span><span style="color:#111">(</span><span style="color:#111">widgets</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>   <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#00a8c8">with</span> <span style="color:#111">open</span><span style="color:#111">(</span><span style="color:#d88200">&#34;toknes.txt&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;a&#39;</span><span style="color:#111">)</span> <span style="color:#00a8c8">as</span> <span style="color:#111">f</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>       <span style="color:#00a8c8">for</span> <span style="color:#111">widget</span> <span style="color:#f92672">in</span> <span style="color:#111">widgets</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>           <span style="color:#00a8c8">if</span> <span style="color:#d88200">&#39;token&#39;</span> <span style="color:#f92672">in</span> <span style="color:#111">widget</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">()</span> <span style="color:#f92672">and</span> <span style="color:#d88200">&#39;request&#39;</span> <span style="color:#f92672">in</span> <span style="color:#111">widget</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">():</span>
</span></span><span style="display:flex;"><span>               <span style="color:#00a8c8">del</span> <span style="color:#111">widget</span><span style="color:#111">[</span><span style="color:#d88200">&#39;helpDialog&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>               <span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">str</span><span style="color:#111">(</span><span style="color:#111">widget</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#d88200">&#34;,</span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>           <span style="color:#00a8c8">if</span> <span style="color:#111">widget</span><span style="color:#111">[</span><span style="color:#d88200">&#39;id&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">==</span> <span style="color:#d88200">&#39;TIMESERIES&#39;</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>               <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#111">widget</span>
</span></span><span style="display:flex;"><span>   <span style="color:#00a8c8">return</span> <span style="color:#111">reqparas</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The output of this step <code>reqparas</code> contains necessary parameters <code>request</code> and <code>token</code> for the request of time series Search Volume Index.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-12-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-12-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">{</span><span style="color:#d88200">&#39;request&#39;</span>: <span style="color:#f92672">{</span><span style="color:#d88200">&#39;time&#39;</span>: <span style="color:#d88200">&#39;2017-08-06 2022-09-06&#39;</span>, <span style="color:#d88200">&#39;resolution&#39;</span>: <span style="color:#d88200">&#39;WEEK&#39;</span>, <span style="color:#d88200">&#39;locale&#39;</span>: <span style="color:#d88200">&#39;en-US&#39;</span>, <span style="color:#d88200">&#39;comparisonItem&#39;</span>: <span style="color:#f92672">[{</span><span style="color:#d88200">&#39;geo&#39;</span>: <span style="color:#f92672">{}</span>, <span style="color:#d88200">&#39;complexKeywordsRestriction&#39;</span>: <span style="color:#f92672">{</span><span style="color:#d88200">&#39;keyword&#39;</span>: <span style="color:#f92672">[{</span><span style="color:#d88200">&#39;type&#39;</span>: <span style="color:#d88200">&#39;BROAD&#39;</span>, <span style="color:#d88200">&#39;value&#39;</span>: <span style="color:#d88200">&#39;aapl&#39;</span><span style="color:#f92672">}]}}</span>, <span style="color:#f92672">{</span><span style="color:#d88200">&#39;geo&#39;</span>: <span style="color:#f92672">{}</span>, <span style="color:#d88200">&#39;complexKeywordsRestriction&#39;</span>: <span style="color:#f92672">{</span><span style="color:#d88200">&#39;keyword&#39;</span>: <span style="color:#f92672">[{</span><span style="color:#d88200">&#39;type&#39;</span>: <span style="color:#d88200">&#39;BROAD&#39;</span>, <span style="color:#d88200">&#39;value&#39;</span>: <span style="color:#d88200">&#39;amzn&#39;</span><span style="color:#f92672">}]}}]</span>, <span style="color:#d88200">&#39;requestOptions&#39;</span>: <span style="color:#f92672">{</span><span style="color:#d88200">&#39;property&#39;</span>: <span style="color:#d88200">&#39;&#39;</span>, <span style="color:#d88200">&#39;backend&#39;</span>: <span style="color:#d88200">&#39;IZG&#39;</span>, <span style="color:#d88200">&#39;category&#39;</span>: 0<span style="color:#f92672">}</span>, <span style="color:#d88200">&#39;userConfig&#39;</span>: <span style="color:#f92672">{</span><span style="color:#d88200">&#39;userType&#39;</span>: <span style="color:#d88200">&#39;USER_TYPE_SCRAPER&#39;</span><span style="color:#f92672">}}</span>, <span style="color:#d88200">&#39;lineAnnotationText&#39;</span>: <span style="color:#d88200">&#39;Search interest&#39;</span>, <span style="color:#d88200">&#39;bullets&#39;</span>: <span style="color:#f92672">[{</span><span style="color:#d88200">&#39;text&#39;</span>: <span style="color:#d88200">&#39;aapl&#39;</span><span style="color:#f92672">}</span>, <span style="color:#f92672">{</span><span style="color:#d88200">&#39;text&#39;</span>: <span style="color:#d88200">&#39;amzn&#39;</span><span style="color:#f92672">}]</span>, <span style="color:#d88200">&#39;showLegend&#39;</span>: False, <span style="color:#d88200">&#39;showAverages&#39;</span>: True, <span style="color:#d88200">&#39;token&#39;</span>: <span style="color:#d88200">&#39;APP6_UEAAAAAYxsGftESZzXrrXfS82XnJlzqaOXskCAk&#39;</span>, <span style="color:#d88200">&#39;id&#39;</span>: <span style="color:#d88200">&#39;TIMESERIES&#39;</span>, <span style="color:#d88200">&#39;type&#39;</span>: <span style="color:#d88200">&#39;fe_line_chart&#39;</span>, <span style="color:#d88200">&#39;title&#39;</span>: <span style="color:#d88200">&#39;Interest over time&#39;</span>, <span style="color:#d88200">&#39;template&#39;</span>: <span style="color:#d88200">&#39;fe&#39;</span>, <span style="color:#d88200">&#39;embedTemplate&#39;</span>: <span style="color:#d88200">&#39;fe_embed&#39;</span>, <span style="color:#d88200">&#39;version&#39;</span>: <span style="color:#d88200">&#39;1&#39;</span>, <span style="color:#d88200">&#39;isLong&#39;</span>: True, <span style="color:#d88200">&#39;isCurated&#39;</span>: False<span style="color:#f92672">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="step-2-request-time-series-of-search-volume-index">Step 2: Request Time Series of Search Volume Index</h4>
<p>The input keyword list and date range is exactly the same as in Step 1. Parameter <code>req</code> and <code>token</code> are both inherited from the output of the Step 1 <code>reqparas</code>.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-13-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-13-15">15</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">fetchdata</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">,</span> <span style="color:#111">daterange</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#111">getoken</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">,</span> <span style="color:#111">daterange</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">time</span><span style="color:#f92672">.</span><span style="color:#111">sleep</span><span style="color:#111">(</span><span style="color:#ae81ff">3</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">params</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;hl&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;en-US&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;tz&#34;</span><span style="color:#111">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">120</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;req&#34;</span> <span style="color:#111">:</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">dumps</span><span style="color:#111">(</span><span style="color:#111">reqparas</span><span style="color:#111">[</span><span style="color:#d88200">&#39;request&#39;</span><span style="color:#111">]),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;token&#34;</span><span style="color:#111">:</span> <span style="color:#111">reqparas</span><span style="color:#111">[</span><span style="color:#d88200">&#39;token&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">con</span> <span style="color:#f92672">=</span> <span style="color:#111">requests</span><span style="color:#f92672">.</span><span style="color:#111">get</span><span style="color:#111">(</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">tsurl</span><span style="color:#111">,</span> <span style="color:#111">headers</span><span style="color:#f92672">=</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">headers</span><span style="color:#111">,</span> <span style="color:#111">cookies</span><span style="color:#f92672">=</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">cookies</span><span style="color:#111">,</span> <span style="color:#111">params</span> <span style="color:#f92672">=</span> <span style="color:#111">params</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">req_json</span> <span style="color:#f92672">=</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">loads</span><span style="color:#111">(</span><span style="color:#111">con</span><span style="color:#f92672">.</span><span style="color:#111">text</span><span style="color:#111">[</span><span style="color:#ae81ff">5</span><span style="color:#111">:])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">req_json</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The output is json-formatted time series of Search Volume Index. The typical format is as following.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-14-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-14-3">3</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">{</span><span style="color:#d88200">&#34;default&#34;</span>:<span style="color:#f92672">{</span><span style="color:#d88200">&#34;timelineData&#34;</span>:<span style="color:#f92672">[{</span><span style="color:#d88200">&#34;time&#34;</span>:<span style="color:#d88200">&#34;1628380800&#34;</span>,<span style="color:#d88200">&#34;formattedTime&#34;</span>:<span style="color:#d88200">&#34;Aug 8 \u2013 14, 2021&#34;</span>,<span style="color:#d88200">&#34;formattedAxisTime&#34;</span>:<span style="color:#d88200">&#34;Aug 8, 2021&#34;</span>,<span style="color:#d88200">&#34;value&#34;</span>:<span style="color:#f92672">[</span>54,34<span style="color:#f92672">]</span>,<span style="color:#d88200">&#34;hasData&#34;</span>:<span style="color:#f92672">[</span>true,true<span style="color:#f92672">]</span>,<span style="color:#d88200">&#34;formattedValue&#34;</span>:<span style="color:#f92672">[</span><span style="color:#d88200">&#34;54&#34;</span>,<span style="color:#d88200">&#34;34&#34;</span><span style="color:#f92672">]}</span>,<span style="color:#f92672">{</span><span style="color:#d88200">&#34;time&#34;</span>:<span style="color:#d88200">&#34;1628985600&#34;</span>,<span style="color:#d88200">&#34;formattedTime&#34;</span>:<span style="color:#d88200">&#34;Aug 15 \u2013 21, 2021&#34;</span>,<span style="color:#d88200">&#34;formattedAxisTime&#34;</span>:<span style="color:#d88200">&#34;Aug 15, 2021&#34;</span>,<span style="color:#d88200">&#34;value&#34;</span>:<span style="color:#f92672">[</span>53,38<span style="color:#f92672">]</span>,<span style="color:#d88200">&#34;hasData&#34;</span>:<span style="color:#f92672">[</span>true,true<span style="color:#f92672">]</span>,
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>,<span style="color:#d88200">&#34;formattedValue&#34;</span>:<span style="color:#f92672">[</span><span style="color:#d88200">&#34;43&#34;</span>,<span style="color:#d88200">&#34;57&#34;</span><span style="color:#f92672">]}</span>,<span style="color:#f92672">{</span><span style="color:#d88200">&#34;time&#34;</span>:<span style="color:#d88200">&#34;1659830400&#34;</span>,<span style="color:#d88200">&#34;formattedTime&#34;</span>:<span style="color:#d88200">&#34;Aug 7 \u2013 13, 2022&#34;</span>,<span style="color:#d88200">&#34;formattedAxisTime&#34;</span>:<span style="color:#d88200">&#34;Aug 7, 2022&#34;</span>,<span style="color:#d88200">&#34;value&#34;</span>:<span style="color:#f92672">[</span>44,48<span style="color:#f92672">]</span>,<span style="color:#d88200">&#34;hasData&#34;</span>:<span style="color:#f92672">[</span>true,true<span style="color:#f92672">]</span>,<span style="color:#d88200">&#34;formattedValue&#34;</span>:<span style="color:#f92672">[</span><span style="color:#d88200">&#34;44&#34;</span>,<span style="color:#d88200">&#34;48&#34;</span><span style="color:#f92672">]}]</span>,<span style="color:#d88200">&#34;averages&#34;</span>:<span style="color:#f92672">[</span>50,43<span style="color:#f92672">]}}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="step-3-clean-and-save-data">Step 3: Clean and Save Data</h4>
<p>The input conatins</p>
<ul>
<li><code>req_json</code>: Json-formatted time series, output of Step 2</li>
<li><code>savefile</code>: File to store the returned results, e.g., &ldquo;GTRES_20220908.csv&rdquo;</li>
<li><code>kw_list</code>: List of search keywords. Properties are the same as in Step 1.</li>
</ul>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-15-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-15-16">16</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">dealjson</span><span style="color:#111">(</span><span style="color:#111">req_json</span><span style="color:#111">,</span> <span style="color:#111">savefile</span><span style="color:#111">,</span> <span style="color:#111">kw_list</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">DataFrame</span><span style="color:#111">(</span><span style="color:#111">req_json</span><span style="color:#111">[</span><span style="color:#d88200">&#39;default&#39;</span><span style="color:#111">][</span><span style="color:#d88200">&#39;timelineData&#39;</span><span style="color:#111">])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">if</span> <span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">empty</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00a8c8">return</span> <span style="color:#111">df</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;date&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">to_datetime</span><span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;time&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">astype</span><span style="color:#111">(</span><span style="color:#111">dtype</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;float64&#39;</span><span style="color:#111">),</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#111">unit</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;s&#39;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">set_index</span><span style="color:#111">([</span><span style="color:#d88200">&#39;date&#39;</span><span style="color:#111">])</span><span style="color:#f92672">.</span><span style="color:#111">sort_index</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">result_df</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;value&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">Series</span><span style="color:#111">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">str</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">replace</span><span style="color:#111">(</span><span style="color:#d88200">&#39;[&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">replace</span><span style="color:#111">(</span><span style="color:#d88200">&#39;]&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">split</span><span style="color:#111">(</span><span style="color:#d88200">&#39;,&#39;</span><span style="color:#111">)))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">for</span> <span style="color:#111">idx</span><span style="color:#111">,</span> <span style="color:#111">kw</span> <span style="color:#f92672">in</span> <span style="color:#111">enumerate</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">result_df</span><span style="color:#f92672">.</span><span style="color:#111">insert</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">result_df</span><span style="color:#f92672">.</span><span style="color:#111">columns</span><span style="color:#111">),</span> <span style="color:#111">kw</span><span style="color:#111">,</span> <span style="color:#111">result_df</span><span style="color:#111">[</span><span style="color:#111">idx</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">astype</span><span style="color:#111">(</span><span style="color:#d88200">&#39;int&#39;</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00a8c8">del</span> <span style="color:#111">result_df</span><span style="color:#111">[</span><span style="color:#111">idx</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">final</span> <span style="color:#f92672">=</span> <span style="color:#111">result_df</span><span style="color:#f92672">.</span><span style="color:#111">stack</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">final</span><span style="color:#f92672">.</span><span style="color:#111">to_csv</span><span style="color:#111">(</span><span style="color:#111">savefile</span><span style="color:#111">,</span> <span style="color:#111">index</span><span style="color:#f92672">=</span><span style="color:#00a8c8">True</span><span style="color:#111">,</span> <span style="color:#111">header</span><span style="color:#f92672">=</span><span style="color:#00a8c8">None</span><span style="color:#111">,</span> <span style="color:#111">mode</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;a&#39;</span><span style="color:#111">)</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><p>The raw dataframe structure is as following.</p>
<table>
<thead>
<tr>
<th>time</th>
<th>formattedTime</th>
<th>formattedAxisTime</th>
<th>value</th>
<th>hasData</th>
<th>formattedValue</th>
</tr>
</thead>
<tbody>
<tr>
<td>1399161600</td>
<td>May 4 - 10, 2014</td>
<td>4-May-14</td>
<td>[96, 5, 0]</td>
<td>[True, True, False]</td>
<td>[&lsquo;96&rsquo;, &lsquo;5&rsquo;, &lsquo;0&rsquo;]</td>
</tr>
<tr>
<td>1399766400</td>
<td>May 11 - 17, 2014</td>
<td>11-May-14</td>
<td>[80, 6, 4]</td>
<td>[True, True, True]</td>
<td>[&lsquo;80&rsquo;, &lsquo;6&rsquo;, &lsquo;4&rsquo;]</td>
</tr>
<tr>
<td>1400371200</td>
<td>May 18 - 24, 2014</td>
<td>18-May-14</td>
<td>[97, 6, 3]</td>
<td>[True, True, True]</td>
<td>[&lsquo;97&rsquo;, &lsquo;6&rsquo;, &lsquo;3&rsquo;]</td>
</tr>
<tr>
<td>1400976000</td>
<td>May 25 - 31, 2014</td>
<td>25-May-14</td>
<td>[86, 6, 5]</td>
<td>[True, True, True]</td>
<td>[&lsquo;86&rsquo;, &lsquo;6&rsquo;, &lsquo;5&rsquo;]</td>
</tr>
<tr>
<td>1401580800</td>
<td>Jun 1 - 7, 2014</td>
<td>1-Jun-14</td>
<td>[82, 5, 3]</td>
<td>[True, True, True]</td>
<td>[&lsquo;82&rsquo;, &lsquo;5&rsquo;, &lsquo;3&rsquo;]</td>
</tr>
<tr>
<td>1402185600</td>
<td>Jun 8 - 14, 2014</td>
<td>8-Jun-14</td>
<td>[76, 8, 5]</td>
<td>[True, True, True]</td>
<td>[&lsquo;76&rsquo;, &lsquo;8&rsquo;, &lsquo;5&rsquo;]</td>
</tr>
<tr>
<td>1402790400</td>
<td>Jun 15 - 21, 2014</td>
<td>15-Jun-14</td>
<td>[87, 6, 2]</td>
<td>[True, True, True]</td>
<td>[&lsquo;87&rsquo;, &lsquo;6&rsquo;, &lsquo;2&rsquo;]</td>
</tr>
<tr>
<td>1403395200</td>
<td>Jun 22 - 28, 2014</td>
<td>22-Jun-14</td>
<td>[74, 3, 2]</td>
<td>[True, True, True]</td>
<td>[&lsquo;74&rsquo;, &lsquo;3&rsquo;, &lsquo;2&rsquo;]</td>
</tr>
<tr>
<td>1404000000</td>
<td>Jun 29 - Jul 5, 2014</td>
<td>29-Jun-14</td>
<td>[74, 0, 0]</td>
<td>[True, False, False]</td>
<td>[&lsquo;74&rsquo;, &lsquo;0&rsquo;, &lsquo;0&rsquo;]</td>
</tr>
<tr>
<td>1404604800</td>
<td>Jul 6 - 12, 2014</td>
<td>6-Jul-14</td>
<td>[84, 3, 2]</td>
<td>[True, True, True]</td>
<td>[&lsquo;84&rsquo;, &lsquo;3&rsquo;, &lsquo;2&rsquo;]</td>
</tr>
<tr>
<td>1405209600</td>
<td>Jul 13 - 19, 2014</td>
<td>13-Jul-14</td>
<td>[71, 5, 2]</td>
<td>[True, True, True]</td>
<td>[&lsquo;71&rsquo;, &lsquo;5&rsquo;, &lsquo;2&rsquo;]</td>
</tr>
</tbody>
</table>
<p>To make sure the columns are comparable among different requests, the formatted and saved dataframe structure has a panel-data format.</p>
<table>
<thead>
<tr>
<th>Date</th>
<th>Symbol</th>
<th>SVI</th>
</tr>
</thead>
<tbody>
<tr>
<td>5/4/2014</td>
<td>DRIV</td>
<td>96</td>
</tr>
<tr>
<td>5/4/2014</td>
<td>DRNA</td>
<td>5</td>
</tr>
<tr>
<td>5/4/2014</td>
<td>DRQ</td>
<td>0</td>
</tr>
<tr>
<td>5/4/2014</td>
<td>DRRX</td>
<td>1</td>
</tr>
<tr>
<td>5/11/2014</td>
<td>DRII</td>
<td>5</td>
</tr>
<tr>
<td>5/11/2014</td>
<td>DRIV</td>
<td>80</td>
</tr>
<tr>
<td>5/11/2014</td>
<td>DRNA</td>
<td>6</td>
</tr>
<tr>
<td>5/11/2014</td>
<td>DRQ</td>
<td>4</td>
</tr>
<tr>
<td>5/11/2014</td>
<td>DRRX</td>
<td>2</td>
</tr>
<tr>
<td>5/18/2014</td>
<td>DRII</td>
<td>2</td>
</tr>
<tr>
<td>5/18/2014</td>
<td>DRIV</td>
<td>97</td>
</tr>
<tr>
<td>5/18/2014</td>
<td>DRNA</td>
<td>6</td>
</tr>
<tr>
<td>5/18/2014</td>
<td>DRQ</td>
<td>3</td>
</tr>
<tr>
<td>5/18/2014</td>
<td>DRRX</td>
<td>4</td>
</tr>
<tr>
<td>5/25/2014</td>
<td>DRII</td>
<td>0</td>
</tr>
<tr>
<td>5/25/2014</td>
<td>DRIV</td>
<td>86</td>
</tr>
<tr>
<td>5/25/2014</td>
<td>DRNA</td>
<td>6</td>
</tr>
<tr>
<td>5/25/2014</td>
<td>DRQ</td>
<td>5</td>
</tr>
<tr>
<td>5/25/2014</td>
<td>DRRX</td>
<td>2</td>
</tr>
</tbody>
</table>
<h3 id="collect-raw-svi">Collect Raw SVI</h3>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-1">  1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-2">  2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-3">  3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-4">  4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-5">  5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-6">  6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-7">  7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-8">  8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-9">  9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-10"> 10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-11"> 11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-12"> 12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-13"> 13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-14"> 14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-15"> 15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-16"> 16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-17"> 17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-18"> 18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-19"> 19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-20"> 20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-21"> 21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-22"> 22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-23"> 23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-24"> 24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-25"> 25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-26"> 26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-27"> 27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-28"> 28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-29"> 29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-30"> 30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-31"> 31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-32"> 32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-33"> 33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-34"> 34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-35"> 35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-36"> 36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-37"> 37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-38"> 38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-39"> 39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-40"> 40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-41"> 41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-42"> 42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-43"> 43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-44"> 44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-45"> 45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-46"> 46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-47"> 47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-48"> 48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-49"> 49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-50"> 50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-51"> 51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-52"> 52</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-53"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-53"> 53</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-54"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-54"> 54</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-55"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-55"> 55</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-56"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-56"> 56</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-57"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-57"> 57</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-58"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-58"> 58</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-59"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-59"> 59</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-60"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-60"> 60</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-61"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-61"> 61</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-62"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-62"> 62</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-63"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-63"> 63</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-64"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-64"> 64</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-65"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-65"> 65</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-66"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-66"> 66</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-67"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-67"> 67</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-68"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-68"> 68</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-69"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-69"> 69</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-70"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-70"> 70</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-71"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-71"> 71</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-72"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-72"> 72</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-73"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-73"> 73</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-74"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-74"> 74</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-75"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-75"> 75</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-76"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-76"> 76</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-77"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-77"> 77</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-78"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-78"> 78</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-79"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-79"> 79</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-80"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-80"> 80</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-81"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-81"> 81</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-82"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-82"> 82</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-83"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-83"> 83</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-84"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-84"> 84</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-85"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-85"> 85</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-86"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-86"> 86</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-87"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-87"> 87</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-88"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-88"> 88</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-89"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-89"> 89</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-90"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-90"> 90</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-91"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-91"> 91</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-92"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-92"> 92</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-93"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-93"> 93</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-94"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-94"> 94</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-95"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-95"> 95</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-96"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-96"> 96</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-97"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-97"> 97</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-98"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-98"> 98</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-99"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-99"> 99</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-100"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-100">100</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-101"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-101">101</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-102"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-102">102</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-103"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-103">103</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-104"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-104">104</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-105"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-105">105</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-106"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-106">106</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-107"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-107">107</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-108"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-108">108</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-16-109"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-16-109">109</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">requests</span>  
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">json</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">pandas</span> <span style="color:#00a8c8">as</span> <span style="color:#111">pd</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">urllib.parse</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> <span style="color:#111">datetime</span> <span style="color:#f92672">import</span> <span style="color:#111">datetime</span><span style="color:#111">,</span> <span style="color:#111">timedelta</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">os</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> <span style="color:#111">random</span> <span style="color:#f92672">import</span> <span style="color:#111">randint</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">time</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> <span style="color:#111">math</span> <span style="color:#f92672">import</span> <span style="color:#111">floor</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> <span style="color:#111">tqdm</span> <span style="color:#f92672">import</span> <span style="color:#111">tqdm</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">class</span> <span style="color:#75af00">gtparas</span><span style="color:#111">(</span><span style="color:#111">object</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">tokenurl</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;https://trends.google.com/trends/api/explore&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">tsurl</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;https://trends.google.com/trends/api/widgetdata/multiline&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">headers</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;User-Agent&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:102.0) Gecko/20100101 Firefox/102.0&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Accept&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Accept-Language&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;en-US,en;q=0.5&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Alt-Used&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;trends.google.com&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Upgrade-Insecure-Requests&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;1&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Sec-Fetch-Dest&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;document&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Sec-Fetch-Mode&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;navigate&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Sec-Fetch-Site&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;none&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                <span style="color:#d88200">&#34;Sec-Fetch-User&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;?1&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">cookies</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;AEC&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;AakniGMZ6nXlsuXNYf-cVEy-z26kpLEg-_E-OHRlDx-o4ApEe6xoCanQRw&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;CONSENT&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;PENDING+772&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;SOCS&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;CAISHAgBEhJnd3NfMjAyMjA4MzEtMF9SQzEaAmRlIAEaBgiA1c-YBg&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;NID&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;511=BOJuzRwaQjxlv1xhQxBRom1aMkVL7CFU1RzfvcARIcHraZHPpuF_ZuCoFJ0YlmH18CbkapTUPEjBR6wm-U15jn_OT4yiyLy5WuMlBVvfSA7FNZ_tvrteTBgHRwXJcfJCC1VhZ0RbWlV881OpXOae007aMkwxgcjaGOZUEdQpd5NTV03c52iMD2jtVJUIyvsg6zU&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;__utmc&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;__utmt&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;1&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;__utma&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256.1871926219.1662307048.1662307048.1662307048.1&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;__utmb&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256.2.9.1662307053878&#34;</span><span style="color:#111">,</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;__utmz&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;10102256.1662307048.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">recordtokens</span><span style="color:#111">(</span><span style="color:#111">widgets</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">with</span> <span style="color:#111">open</span><span style="color:#111">(</span><span style="color:#d88200">&#34;toknes.txt&#34;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;a&#39;</span><span style="color:#111">)</span> <span style="color:#00a8c8">as</span> <span style="color:#111">f</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00a8c8">for</span> <span style="color:#111">widget</span> <span style="color:#f92672">in</span> <span style="color:#111">widgets</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#00a8c8">if</span> <span style="color:#d88200">&#39;token&#39;</span> <span style="color:#f92672">in</span> <span style="color:#111">widget</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">()</span> <span style="color:#f92672">and</span> <span style="color:#d88200">&#39;request&#39;</span> <span style="color:#f92672">in</span> <span style="color:#111">widget</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">():</span>
</span></span><span style="display:flex;"><span>                <span style="color:#00a8c8">del</span> <span style="color:#111">widget</span><span style="color:#111">[</span><span style="color:#d88200">&#39;helpDialog&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>                <span style="color:#111">f</span><span style="color:#f92672">.</span><span style="color:#111">write</span><span style="color:#111">(</span><span style="color:#111">str</span><span style="color:#111">(</span><span style="color:#111">widget</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#d88200">&#34;,</span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#00a8c8">if</span> <span style="color:#111">widget</span><span style="color:#111">[</span><span style="color:#d88200">&#39;id&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">==</span> <span style="color:#d88200">&#39;TIMESERIES&#39;</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>                <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#111">widget</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">reqparas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">getoken</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">,</span> <span style="color:#111">daterange</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">token_payload</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#d88200">&#39;hl&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;en-US&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#d88200">&#39;tz&#39;</span><span style="color:#111">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">120</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>            <span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">:</span> <span style="color:#111">{</span><span style="color:#d88200">&#39;comparisonItem&#39;</span><span style="color:#111">:</span> <span style="color:#111">[],</span> <span style="color:#d88200">&#39;category&#39;</span><span style="color:#111">:</span> <span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;property&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">for</span> <span style="color:#111">kw</span> <span style="color:#f92672">in</span> <span style="color:#111">kw_list</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">keyword_payload</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#d88200">&#39;keyword&#39;</span><span style="color:#111">:</span> <span style="color:#111">kw</span><span style="color:#f92672">.</span><span style="color:#111">lower</span><span style="color:#111">(),</span> <span style="color:#d88200">&#39;geo&#39;</span><span style="color:#111">:</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>                               <span style="color:#d88200">&#39;time&#39;</span><span style="color:#111">:</span> <span style="color:#111">daterange</span><span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">token_payload</span><span style="color:#111">[</span><span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">][</span><span style="color:#d88200">&#39;comparisonItem&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">keyword_payload</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">token_payload</span><span style="color:#111">[</span><span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">dumps</span><span style="color:#111">(</span><span style="color:#111">token_payload</span><span style="color:#111">[</span><span style="color:#d88200">&#39;req&#39;</span><span style="color:#111">])</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#111">con</span> <span style="color:#f92672">=</span> <span style="color:#111">requests</span><span style="color:#f92672">.</span><span style="color:#111">post</span><span style="color:#111">(</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">tokenurl</span><span style="color:#111">,</span> <span style="color:#111">headers</span> <span style="color:#f92672">=</span> <span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">headers</span><span style="color:#111">,</span> <span style="color:#111">cookies</span><span style="color:#f92672">=</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">cookies</span><span style="color:#111">,</span> <span style="color:#111">params</span> <span style="color:#f92672">=</span> <span style="color:#111">token_payload</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">widgets</span> <span style="color:#f92672">=</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">loads</span><span style="color:#111">(</span><span style="color:#111">con</span><span style="color:#f92672">.</span><span style="color:#111">text</span><span style="color:#111">[</span><span style="color:#ae81ff">5</span><span style="color:#111">:])[</span><span style="color:#d88200">&#39;widgets&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#111">recordtokens</span><span style="color:#111">(</span><span style="color:#111">widgets</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">return</span> <span style="color:#111">reqparas</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">dealjson</span><span style="color:#111">(</span><span style="color:#111">req_json</span><span style="color:#111">,</span> <span style="color:#111">savefile</span><span style="color:#111">,</span> <span style="color:#111">kw_list</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">DataFrame</span><span style="color:#111">(</span><span style="color:#111">req_json</span><span style="color:#111">[</span><span style="color:#d88200">&#39;default&#39;</span><span style="color:#111">][</span><span style="color:#d88200">&#39;timelineData&#39;</span><span style="color:#111">])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">to_csv</span><span style="color:#111">(</span><span style="color:#d88200">&#34;test1.csv&#34;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">if</span> <span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">empty</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00a8c8">return</span> <span style="color:#111">df</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;date&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">to_datetime</span><span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;time&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">astype</span><span style="color:#111">(</span><span style="color:#111">dtype</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;float64&#39;</span><span style="color:#111">),</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#111">unit</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;s&#39;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">set_index</span><span style="color:#111">([</span><span style="color:#d88200">&#39;date&#39;</span><span style="color:#111">])</span><span style="color:#f92672">.</span><span style="color:#111">sort_index</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">result_df</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200">&#39;value&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">Series</span><span style="color:#111">(</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">str</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">replace</span><span style="color:#111">(</span><span style="color:#d88200">&#39;[&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">replace</span><span style="color:#111">(</span><span style="color:#d88200">&#39;]&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">split</span><span style="color:#111">(</span><span style="color:#d88200">&#39;,&#39;</span><span style="color:#111">)))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">for</span> <span style="color:#111">idx</span><span style="color:#111">,</span> <span style="color:#111">kw</span> <span style="color:#f92672">in</span> <span style="color:#111">enumerate</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">result_df</span><span style="color:#f92672">.</span><span style="color:#111">insert</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">result_df</span><span style="color:#f92672">.</span><span style="color:#111">columns</span><span style="color:#111">),</span> <span style="color:#111">kw</span><span style="color:#111">,</span> <span style="color:#111">result_df</span><span style="color:#111">[</span><span style="color:#111">idx</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">astype</span><span style="color:#111">(</span><span style="color:#d88200">&#39;int&#39;</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00a8c8">del</span> <span style="color:#111">result_df</span><span style="color:#111">[</span><span style="color:#111">idx</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">final</span> <span style="color:#f92672">=</span> <span style="color:#111">result_df</span><span style="color:#f92672">.</span><span style="color:#111">stack</span><span style="color:#111">()</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">print</span><span style="color:#111">(</span><span style="color:#111">final</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">final</span><span style="color:#f92672">.</span><span style="color:#111">to_csv</span><span style="color:#111">(</span><span style="color:#111">savefile</span><span style="color:#111">,</span> <span style="color:#111">index</span><span style="color:#f92672">=</span><span style="color:#00a8c8">True</span><span style="color:#111">,</span> <span style="color:#111">header</span><span style="color:#f92672">=</span><span style="color:#00a8c8">None</span><span style="color:#111">,</span> <span style="color:#111">mode</span><span style="color:#f92672">=</span><span style="color:#d88200">&#39;a&#39;</span><span style="color:#111">)</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">fetchdata</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">,</span> <span style="color:#111">daterange</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">reqparas</span> <span style="color:#f92672">=</span> <span style="color:#111">getoken</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">,</span> <span style="color:#111">daterange</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">time</span><span style="color:#f92672">.</span><span style="color:#111">sleep</span><span style="color:#111">(</span><span style="color:#ae81ff">3</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">params</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;hl&#34;</span><span style="color:#111">:</span> <span style="color:#d88200">&#34;en-US&#34;</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;tz&#34;</span><span style="color:#111">:</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">120</span><span style="color:#111">,</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;req&#34;</span> <span style="color:#111">:</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">dumps</span><span style="color:#111">(</span><span style="color:#111">reqparas</span><span style="color:#111">[</span><span style="color:#d88200">&#39;request&#39;</span><span style="color:#111">]),</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d88200">&#34;token&#34;</span><span style="color:#111">:</span> <span style="color:#111">reqparas</span><span style="color:#111">[</span><span style="color:#d88200">&#39;token&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">con</span> <span style="color:#f92672">=</span> <span style="color:#111">requests</span><span style="color:#f92672">.</span><span style="color:#111">get</span><span style="color:#111">(</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">tsurl</span><span style="color:#111">,</span> <span style="color:#111">headers</span><span style="color:#f92672">=</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">headers</span><span style="color:#111">,</span> <span style="color:#111">cookies</span><span style="color:#f92672">=</span><span style="color:#111">gtparas</span><span style="color:#f92672">.</span><span style="color:#111">cookies</span><span style="color:#111">,</span> <span style="color:#111">params</span> <span style="color:#f92672">=</span> <span style="color:#111">params</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">req_json</span> <span style="color:#f92672">=</span> <span style="color:#111">json</span><span style="color:#f92672">.</span><span style="color:#111">loads</span><span style="color:#111">(</span><span style="color:#111">con</span><span style="color:#f92672">.</span><span style="color:#111">text</span><span style="color:#111">[</span><span style="color:#ae81ff">5</span><span style="color:#111">:])</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">dealjson</span><span style="color:#111">(</span><span style="color:#111">req_json</span><span style="color:#111">,</span> <span style="color:#111">savefile</span><span style="color:#111">,</span> <span style="color:#111">kw_list</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">if</span> <span style="color:#111">__name__</span> <span style="color:#f92672">==</span> <span style="color:#d88200">&#39;__main__&#39;</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">kw_list</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200">&#39;AAPL&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;AMZN&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;TSLA&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">daterange</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#39;2021-08-08 2022-08-08&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">fetchdata</span><span style="color:#111">(</span><span style="color:#111">kw_list</span><span style="color:#111">,</span> <span style="color:#111">daterange</span><span style="color:#111">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="formulate-institutional-information-acquisition-measure-aia">Formulate Institutional Information Acquisition Measure (AIA)</h2>
<h3 id="bloomberg-as-the-data-source">Bloomberg as the Data Source</h3>
<p>To my knowledge, Ben-Rephael, Da, Israelsen (2017, RFS) was the first to use the Bloomberg Read Heat (AIA) was firstly as a proxy for institutional attention. According to their paper, <em>Bloomberg records the number of times news articles on a particular stock are read by its terminal users and the number of times users actively search for news about a specific stock. &hellip; They assign a score of 0 if the rolling average is in the lowest 80% of the hourly counts over the previous 30 days. Similarly, Bloomberg assigns a score of 1, 2, 3 or 4 if the average is between 80% and 90%, 90% and 94%, 94% and 96%, or greater than 96% of the previous 30 days hourly counts, respectively. &hellip; Bloomberg aggregates up to the daily frequency by taking a maximum of all hourly scores throughout the calendar day</em>.</p>
<h3 id="collect-bloomberg-news-read-heat">Collect Bloomberg News Read Heat</h3>
<p>In my previously blog <a href="https://mengjiexu.com/post/bloomberg-api/">Extract Mass Data Via Bloomberg API</a>, I have displayed how to obtain a specific variable from Bloomberg via Bloomberg API. In this case, the variable of interest <code>NEWS_HEAT_READ_DMAX</code>. Maybe you also want to obtain some related variables like the number of news per day and the tone of the news, etc.</p>
<p>Then just request them from the Bloomberg.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-47">47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-48">48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-49">49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-50">50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-51">51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-17-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-17-52">52</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">pandas</span> <span style="color:#00a8c8">as</span> <span style="color:#111">pd</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> <span style="color:#111">xbbg</span> <span style="color:#f92672">import</span> <span style="color:#111">blp</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> <span style="color:#111">tqdm</span> <span style="color:#f92672">import</span> <span style="color:#111">tqdm</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#111">csv</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">read_excel</span><span style="color:#111">(</span><span style="color:#d88200">&#39;cusiplist.xlsx&#39;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#111">date_from</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#39;20090101&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#111">date_until</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#39;20210630&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#111">target</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200">&#39;NEWS_HEAT_READ_DMAX&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;NEWS_HEAT_READ_DAVG&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;NEWS_HEAT_PUB_DAVG&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;NEWS_SENTIMENT_DAILY_AVG&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;NEWS_HEAT_PUB_DNUMSTORIES&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;NEWS_HEAT_PUB_DMAX&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;NEWS_NEG_SENTIMENT_COUNT&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;NEWS_POS_SENTIMENT_COUNT&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;NEWS_PUBLICATION_COUNT&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">def</span> <span style="color:#75af00">prepare</span><span style="color:#111">(</span><span style="color:#111">temp</span><span style="color:#111">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">cols</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">temp</span><span style="color:#f92672">.</span><span style="color:#111">columns</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">diff</span> <span style="color:#f92672">=</span> <span style="color:#111">set</span><span style="color:#111">(</span><span style="color:#111">target</span><span style="color:#111">)</span> <span style="color:#f92672">-</span> <span style="color:#111">set</span><span style="color:#111">(</span><span style="color:#111">cols</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">diffindex</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#111">target</span><span style="color:#f92672">.</span><span style="color:#111">index</span><span style="color:#111">(</span><span style="color:#111">i</span><span style="color:#111">)</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">diff</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">leftindex</span> <span style="color:#f92672">=</span> <span style="color:#111">set</span><span style="color:#111">(</span><span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">target</span><span style="color:#111">)))</span> <span style="color:#f92672">-</span> <span style="color:#111">set</span><span style="color:#111">(</span><span style="color:#111">diffindex</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">dictt</span> <span style="color:#f92672">=</span> <span style="color:#111">list</span><span style="color:#111">(</span><span style="color:#111">zip</span><span style="color:#111">(</span><span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">cols</span><span style="color:#111">)),</span> <span style="color:#111">leftindex</span><span style="color:#111">))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">return</span><span style="color:#111">([</span><span style="color:#111">cols</span><span style="color:#111">,</span> <span style="color:#111">dictt</span><span style="color:#111">])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Iterate each cusip in the cusip list</span>
</span></span><span style="display:flex;"><span><span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">tqdm</span><span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">iterrows</span><span style="color:#111">()):</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#75715e"># Obtain cusip</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">cusip</span> <span style="color:#f92672">=</span> <span style="color:#111">i</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">][</span><span style="color:#ae81ff">2</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Request data from Bloomberg API</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">temp</span> <span style="color:#f92672">=</span> <span style="color:#111">blp</span><span style="color:#f92672">.</span><span style="color:#111">bdh</span><span style="color:#111">(</span><span style="color:#111">tickers</span><span style="color:#f92672">=</span><span style="color:#111">cusip</span><span style="color:#111">,</span><span style="color:#111">flds</span><span style="color:#f92672">=</span><span style="color:#111">target</span><span style="color:#111">,</span> <span style="color:#111">start_date</span><span style="color:#f92672">=</span><span style="color:#111">date_from</span><span style="color:#111">,</span>\
</span></span><span style="display:flex;"><span>                   <span style="color:#111">end_date</span><span style="color:#f92672">=</span><span style="color:#111">date_until</span><span style="color:#111">,</span> <span style="color:#111">Per</span> <span style="color:#f92672">=</span> <span style="color:#d88200">&#39;Y&#39;</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#111">[</span><span style="color:#111">cols</span><span style="color:#111">,</span> <span style="color:#111">dictt</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">prepare</span><span style="color:#111">(</span><span style="color:#111">temp</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#00a8c8">with</span> <span style="color:#111">open</span><span style="color:#111">(</span><span style="color:#d88200">&#39;Esg_Score_Multiple&#39;</span><span style="color:#111">,</span><span style="color:#d88200">&#39;a&#39;</span><span style="color:#111">)</span> <span style="color:#00a8c8">as</span> <span style="color:#111">f</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>      	<span style="color:#75715e"># Open a csv file with mode &#39;a&#39;, which allows adding new rows</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># without covering existed rows</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">g</span> <span style="color:#f92672">=</span> <span style="color:#111">csv</span><span style="color:#f92672">.</span><span style="color:#111">writer</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Create a list with length equal to the number of requested </span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># variables plus 3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">headline</span> <span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#d88200">&#39;DATE&#39;</span><span style="color:#111">]</span><span style="color:#f92672">+</span><span style="color:#111">target</span><span style="color:#f92672">+</span><span style="color:#111">[</span><span style="color:#d88200">&#39;CUSIP&#39;</span><span style="color:#111">,</span> <span style="color:#d88200">&#39;FIELDS&#39;</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#111">res</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200">&#34;&#34;</span><span style="color:#111">]</span><span style="color:#f92672">*</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">target</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">3</span><span style="color:#111">)</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Iterate each row of returned dataframe</span>
</span></span><span style="display:flex;"><span>        <span style="color:#00a8c8">for</span> <span style="color:#111">row</span> <span style="color:#f92672">in</span> <span style="color:#111">temp</span><span style="color:#f92672">.</span><span style="color:#111">iterrows</span><span style="color:#111">():</span>
</span></span><span style="display:flex;"><span>            <span style="color:#00a8c8">for</span> <span style="color:#111">j</span><span style="color:#111">,</span><span style="color:#111">k</span>  <span style="color:#f92672">in</span> <span style="color:#111">dictt</span><span style="color:#111">:</span>
</span></span><span style="display:flex;"><span>              	<span style="color:#75715e"># Put date to the first cell</span>
</span></span><span style="display:flex;"><span>                <span style="color:#111">res</span><span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">row</span><span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># Put variables returned by API following the</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># pre-specified order</span>
</span></span><span style="display:flex;"><span>                <span style="color:#111">res</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">row</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">][</span><span style="color:#111">j</span><span style="color:#111">]</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># Put the identifier of security into the list</span>
</span></span><span style="display:flex;"><span>                <span style="color:#111">res</span><span style="color:#111">[</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">target</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">cusip</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># Put names of valid variables returned for the security</span>
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># into the last cell of the list for cross-check</span>
</span></span><span style="display:flex;"><span>                <span style="color:#111">res</span><span style="color:#111">[</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">target</span><span style="color:#111">)</span><span style="color:#f92672">+</span><span style="color:#ae81ff">2</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">cols</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Write the revised list to the opened csv file</span>
</span></span><span style="display:flex;"><span>            <span style="color:#111">g</span><span style="color:#f92672">.</span><span style="color:#111">writerow</span><span style="color:#111">(</span><span style="color:#111">res</span><span style="color:#111">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="summary">Summary</h2>
<p>In this blog, I showed the value of investors&rsquo; attention (or information acquisition actions) and introduced how to collect data for the purpose of formulating the proxies of retail attention and institutional attention respectively. Following Ben-Rephael, Da, Israelsen (2017, RFS)  and Ben-Repahael, Da, Israelsen (2021, TAR) , I use Google Search Volume Index (SVI) to capture retail attention and news reading intensity for specific stocks on Bloomberg terminals as a new proxy for institutional investor attention.</p>
<h2 id="references">References</h2>
<p>Ben-Rephael, Azi, Zhi Da, and Ryan D. Israelsen. &ldquo;It depends on where you search: Institutional investor attention and underreaction to news.&rdquo; <em>The Review of Financial Studies</em> 30, no. 9 (2017): 3009-3047.</p>
<p>Da, Zhi, Joseph Engelberg, and Pengjie Gao. &ldquo;In search of attention.&rdquo; <em>The Journal of Finance</em> 66, no. 5 (2011): 1461-1499.</p>
<p>Drake, Michael S., Bret A. Johnson, Darren T. Roulstone, and Jacob R. Thornock. &ldquo;Is there information content in information acquisition?.&rdquo; <em>The Accounting Review</em> 95, no. 2 (2020): 113-139.</p>
<p>Lee, Charles MC, and Eric C. So. &ldquo;Alphanomics: The informational underpinnings of market efficiency.&rdquo; <em>Foundations and Trends in Accounting</em> 9.23 (2015): 59-258.</p>
<p>Peter Easton, Azi Ben-Repahael, Zhi Da, Ryan Israelsen. &ldquo;Who Pays Attention to SEC Form 8-K?.&rdquo; <em>The Accounting Review</em> (2021)</p>


                

                
                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/collect-daily-level-short-selling-data-with-no-costs-and-no-delay/" data-toggle="tooltip" data-placement="top" title="Collect Daily Level Short Sale Data From FINRA With Low Costs and Low Delay">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/an-information-based-decomposition-of-stock-price/" data-toggle="tooltip" data-placement="top" title="Theory for the information-based decomposition of stock price">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>
                

                


            </div>

            
            
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
            

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                

                
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">                  
                    
                    <li>
                        <a href="mailto:mx67@duke.edu">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		           
                    
                    <li>
                        <a href="https://twitter.com/xumj2021">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    

		            
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/xumj2021">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		            
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/mengjie-xu-37410712b/">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		           
                    
                    
                    
                    
                    
                    
            
            
            
           
                   <li>
                       <a href='' rel="alternate" type="application/rss+xml" title="Democratize Data For Insights" >
                           <span class="fa-stack fa-lg">
                               <i class="fas fa-circle fa-stack-2x"></i>
                               <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
            
             </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Mengjie Xu 2025
                    
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function loadAsync(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        loadAsync("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






<script type="text/javascript">
    function generateCatalog(selector) {

        
        
        
        
            _containerSelector = 'div.post-container'
        

        
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        
        $(selector).html('')

        
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    


    loadAsync("\/js\/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>






</body>
</html>
